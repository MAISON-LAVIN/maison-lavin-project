<apex:page standardController="Opportunity" renderAs="pdf" applyBodyTag="false">
    <head>
        <style>
            @page {
                size: A4;
                margin: 2cm 3cm;
            }
            
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }
            
            body {
                font-family: 'Courier New', Courier, monospace;
                font-size: 10pt;
                line-height: 1.6;
                color: #000;
            }
            
            .company-header {
                text-align: center;
                margin-bottom: 40px;
            }
            
            .company-logo {
                border: 2px solid #000;
                padding: 15px 40px;
                display: inline-block;
                margin-bottom: 10px;
            }
            
            .company-name {
                font-size: 18pt;
                font-weight: bold;
                letter-spacing: 3px;
            }
            
            .company-subtitle {
                font-size: 8pt;
                letter-spacing: 2px;
                margin-top: 5px;
            }
            
            .company-tagline {
                font-size: 7pt;
                letter-spacing: 1px;
                margin-top: 5px;
                color: #666;
            }
            
            .company-info {
                text-align: right;
                font-size: 8pt;
                margin-bottom: 10px;
                line-height: 1.5;
            }
            
            .divider {
                border-top: 1px solid #000;
                margin: 20px 0;
            }
            
            .invoice-title {
                font-size: 11pt;
                margin-bottom: 5px;
            }

            .invoice-date {
                font-size: 9pt;
                margin-bottom: 20px;
            }
            
            .invoice-meta {
                display: table;
                width: 100%;
                margin-bottom: 40px;
                font-size: 9pt;
            }
            
            .invoice-meta-row {
                display: table-row;
            }
            
            .invoice-meta-row > div {
                display: table-cell;
                padding: 2px 0;
            }
            
            .invoice-label {
                width: 35%;
            }
            
            .invoice-value {
                width: 65%;
                text-align: right;
            }
            
            .quotation-line {
                border-bottom: 1px solid #ddd;
                padding: 15px 0;
                display: table;
                width: 100%;
                font-size: 9pt;
            }
            
            .quotation-line-row {
                display: table-row;
            }
            
            .quotation-line-row > div {
                display: table-cell;
                padding: 3px 0;
            }
            
            .item-number {
                width: 10%;
            }
            
            .item-description {
                width: 55%;
            }
            
            .item-price {
                width: 35%;
                text-align: right;
            }
            
            .amounts {
                margin-top: 30px;
                font-size: 9pt;
            }
            
            .amount-row {
                text-align: right;
                padding: 5px 0;
            }
            
            .amount-label {
                display: inline-block;
                width: 150px;
                text-align: left;
            }
            
            .amount-value {
                display: inline-block;
                width: 120px;
                text-align: right;
            }
            
            .total-row {
                border-top: 1px solid #000;
                margin-top: 10px;
                padding-top: 10px;
                font-weight: bold;
            }
            
            .payment-info {
                margin-top: 40px;
                font-size: 9pt;
            }
            
            .design-section {
                page-break-before: always;
                margin-top: 40px;
            }
            
            .design-title {
                font-size: 11pt;
                margin-bottom: 30px;
                padding-bottom: 10px;
                border-bottom: 1px solid #000;
            }
            
            .design-images {
                margin-top: 30px;
            }
            
            .image-container {
                text-align: center;
                margin: 30px 0;
                page-break-inside: avoid;
            }
            
            .image-container img {
                max-width: 400px;
                max-height: 350px;
                border: 1px solid #ddd;
                padding: 10px;
            }
            
            .image-caption {
                font-size: 8pt;
                color: #666;
                margin-top: 10px;
            }
            
            .footer-notes {
                margin-top: 60px;
                font-size: 7pt;
                text-align: center;
                color: #666;
                line-height: 1.8;
            }
        </style>
    </head>
    
    <body>
        <!-- Company Header -->
        <div class="company-header">
            <div class="company-logo">
                <div class="company-name">MAISON LAVIN</div>
            </div>
            <div class="company-tagline">ESTABLISHED 1989</div>
        </div>
        
        <!-- Company Info -->
        <div class="company-info">
            Company: Maison Lavin Korea Inc.<br/>
            Representative: Kevin Kang<br/>
            <br/>
            www.maisonlavin.com
        </div>
        
        <div class="divider"></div>
        
        <!-- Invoice Info -->
        <div class="invoice-title">*Invoice*</div>
        <div class="invoice-date">
            <apex:outputText value="{0, date, MMMM dd yyyy}">
                <apex:param value="{!TODAY()}" />
            </apex:outputText>
        </div>
        
        <div class="invoice-meta">
            <div class="invoice-meta-row">
                <div class="invoice-label">Quotation No.</div>
                <div class="invoice-value">QT-{!Opportunity.Id}</div>
            </div>
            <div class="invoice-meta-row">
                <div class="invoice-label">Customer</div>
                <div class="invoice-value">{!Opportunity.Account.Name}</div>
            </div>
            <div class="invoice-meta-row">
                <div class="invoice-label">Manager</div>
                <div class="invoice-value">{!Opportunity.Owner.Name}</div>
            </div>
        </div>
        
        <!-- Quotation Line -->
        <div class="quotation-line">
            <div class="quotation-line-row">
                <div class="item-number">1</div>
                <div class="item-description">{!Opportunity.Name}</div>
                <div class="item-price">
                    <apex:outputText value="{0, number, ###,###,###}">
                        <apex:param value="{!Opportunity.Total_Amount__c}" />
                    </apex:outputText>
                </div>
            </div>
        </div>
        
        <!-- Amount Summary -->
        <div class="amounts">
            <div class="amount-row">
                <span class="amount-label">SUB TOTAL</span>
                <span class="amount-value">KRW</span>
                <span class="amount-value">
                    <apex:outputText value="{0, number, ###,###,###}">
                        <apex:param value="{!Opportunity.Total_Amount__c}" />
                    </apex:outputText>
                </span>
            </div>
            
            <div class="amount-row total-row">
                <span class="amount-label">TOTAL</span>
                <span class="amount-value">KRW</span>
                <span class="amount-value">
                    <apex:outputText value="{0, number, ###,###,###}">
                        <apex:param value="{!Opportunity.Total_Amount__c}" />
                    </apex:outputText>
                </span>
            </div>
            
            <div class="amount-row" style="margin-top: 20px;">
                <span class="amount-value"></span>
                <span class="amount-value"></span>
                <span class="amount-value">KRW</span>
            </div>
        </div>
        
        <!-- Footer Notes -->
        <div class="footer-notes">
            This quotation is valid for 30 days from the date of issue.<br/>
            Product exchanges are available within 7 days of purchase for unused items in original condition.<br/>
            Exchange must be made within 14 days with the original invoice.<br/>
            Products damaged due to mishandling are not eligible for exchange.
        </div>
        
        <!-- Design Proposal (Page 2) -->
        <div class="design-section">
            <div class="design-title">Design Proposal</div>
            
            <div class="design-images">
                <apex:repeat value="{!Opportunity.ContentDocumentLinks}" var="cdl">
                    <div class="image-container">
                        <img src="/sfc/servlet.shepherd/version/download/{!cdl.ContentDocument.LatestPublishedVersionId}" />
                        <div class="image-caption">{!cdl.ContentDocument.Title}</div>
                    </div>
                </apex:repeat>
            </div>
            
            <div class="footer-notes" style="margin-top: 80px;">
                Final product may vary slightly from the design proposal.<br/>
                Production time is 2-3 weeks after final design approval.<br/>
            </div>
        </div>
    </body>
</apex:page>